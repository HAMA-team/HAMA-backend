# 🔍 완전한 사용자 시나리오 매핑 (총 22개 카테고리, 100+ 시나리오)

## 📋 목차

### 기본 시나리오 (카테고리 1-12)
1. [간단한 질의](#카테고리-1-간단한-질의-supervisor-직접-답변)
2. [단순 종목 정보 조회](#카테고리-2-단순-종목-정보-조회)
3. [종목 세부 분석](#카테고리-3-종목-세부-분석-매수매도-판단-제외)
4. [종목 분석 + 투자 의사결정](#카테고리-4-종목-분석--투자-의사결정)
5. [종목 비교](#카테고리-5-종목-비교)
6. [시장 상황/전망](#카테고리-6-시장-상황전망)
7. [포트폴리오 조회/평가](#카테고리-7-포트폴리오-조회평가)
8. [포트폴리오 변경 제안](#카테고리-8-포트폴리오-변경-제안)
9. [매매 실행](#카테고리-9-매매-실행)
10. [복합 명령](#카테고리-10-복합-명령-순차-실행)
11. [컨텍스트 의존 질문](#카테고리-11-컨텍스트-의존-질문)
12. [애매한/잘못된 요청](#카테고리-12-애매한잘못된-요청)

### 확장 시나리오 (카테고리 13-22)
13. [투자 학습/교육 요청](#카테고리-13-투자-학습교육-요청)
14. [감정 기반 의사결정 지원](#카테고리-14-감정-기반-의사결정-지원)
15. [세금/수수료 최적화](#카테고리-15-세금수수료-최적화)
16. [시스템 성과 검증/비교](#카테고리-16-시스템-성과-검증비교)
17. [장기 목표/은퇴 계획](#카테고리-17-장기-목표은퇴-계획)
18. [설명/투명성 요청](#카테고리-18-설명투명성-요청)
19. [알림/자동화 설정](#카테고리-19-알림자동화-설정)
20. [소셜/벤치마킹 기능](#카테고리-20-소셜벤치마킹-기능)
21. [시나리오 시뮬레이션](#카테고리-21-시나리오-시뮬레이션)
22. [뉴스/이벤트 대응](#카테고리-22-뉴스이벤트-대응)

---

## 📌 기본 시나리오 (카테고리 1-12)

### 카테고리 1: 간단한 질의 (Supervisor 직접 답변)

**토큰: ~50**

| 시나리오 | 예시 | 처리 방법 |
|----------|------|----------|
| 1-1. 투자 용어 | "PER이 뭐야?", "배당이란?" | Supervisor 직접 답변 (LLM 기본 지식) |
| 1-2. 시스템 사용법 | "자동화 레벨이 뭐야?", "어떻게 써?" | Supervisor 직접 답변 |
| 1-3. 일반 금융 지식 | "주식 시장은 어떻게 작동해?" | Supervisor 직접 답변 |

---

### 카테고리 2: 단순 종목 정보 조회

**토큰: 200-500 (Research Agent Quick 모드)**

| 시나리오 | 예시 | 서브에이전트 | 실행 방식 | 이유 |
|----------|------|-------------|----------|------|
| 2-1. 현재가 조회 | "삼성전자 현재가?" | Data Worker (1개) | Quick | 기본 데이터만 |
| 2-2. 재무제표 조회 | "재무제표 보여줘" | Data Worker (1개) | Quick | 원시 데이터 반환 |
| 2-3. 주가 변동 | "오늘 얼마나 올랐어?" | Data Worker (1개) | Quick | 단순 계산 |
| 2-4. 기본 지표 | "PER/PBR은?" | Data Worker (1개) | Quick | 기본 지표만 |

**라우팅**: research_agent (1개)

---

### 카테고리 3: 종목 세부 분석 (매수/매도 판단 제외)

**토큰: 1000-2000 (Research + Strategy Standard 모드)**

| 시나리오 | 예시 | 서브에이전트 조합 | 실행 방식 | 이유 |
|----------|------|-----------------|----------|------|
| 3-1. 기술적 분석 | "차트 분석해줘", "기술적으로 어때?" | Research: Data Worker, Technical Analyst (2개) | Standard, 병렬 | 차트 패턴, 지표 해석 필요 |
| 3-2. 재무 분석 | "재무 상태 괜찮아?", "펀더멘털 어때?" | Research: Data Worker (1개) + Strategy: Buy Specialist (점수 없이 평가만) | Standard, 병렬 | 재무제표 → 건전성 평가 |
| 3-3. 전망 분석 | "앞으로 전망은?", "장기 성장 가능성은?" | Research: Bull/Bear Analyst, Macro Worker (2개) | Standard, 병렬 | 미래 시나리오, 거시 환경 |
| 3-4. 수급 분석 | "외국인이 사고 있어?", "수급 어때?" | Research: Trading Flow Analyst (1개) | Standard | 투자자별 매매 동향 |
| 3-5. 뉴스/이슈 분석 | "최근 이슈는?", "호재/악재 있어?" | Research: Information Analyst (1개) | Standard | 뉴스 센티먼트 |
| 3-6. 거품 여부 분석 | "고평가됐어?", "거품 아니야?" | Research: Data Worker, Technical Analyst, Bull/Bear Analyst (3개) + Risk | Standard, 병렬 | 밸류에이션 + 리스크 |

**라우팅**: research_agent + strategy_agent (2개, 병렬)  
**예외**: 3-6은 risk_agent 추가 (3개, 병렬)

---

### 카테고리 4: 종목 분석 + 투자 의사결정

**토큰: 2000-4000 (Research + Strategy + Risk Comprehensive 모드)**

| 시나리오 | 예시 | 서브에이전트 조합 | 실행 방식 | 이유 |
|----------|------|-----------------|----------|------|
| 4-1. 매수 타이밍 판단 | "지금 사도 될까?", "매수 타이밍이야?" | Research: 전체 7개 Worker + Strategy: Buy Specialist, Risk/Reward Calculator + Risk | Comprehensive, 병렬 | 종합 평가 + 리스크 + 손절/목표가 |
| 4-2. 매도 타이밍 판단 | "지금 팔아야 해?", "익절해도 돼?" | Research: Data Worker, Information Analyst (2개) + Strategy: Sell Specialist + Risk | Standard, 병렬 | 현재 상황 + 매도 신호 + 리스크 |
| 4-3. 손절 판단 | "손절해야 할까?", "더 기다려야 해?" | Research: Data Worker, Technical Analyst, Information Analyst (3개) + Strategy: Sell Specialist + Risk | Standard, 병렬 | 추세 + 악재 + 리스크 |
| 4-4. 추가 매수 판단 | "물타기해도 돼?", "더 사도 될까?" | Research: 전체 7개 + Strategy: Buy Specialist + Risk (집중도 체크) | Comprehensive, 병렬 | 평가 + 포트폴리오 리스크 |

**라우팅**: research_agent + strategy_agent + risk_agent (3개, 병렬)

---

### 카테고리 5: 종목 비교

**토큰: 1500-3000 (Research + Strategy, 종목당 병렬)**

| 시나리오 | 예시 | 서브에이전트 조합 | 실행 방식 | 이유 |
|----------|------|-----------------|----------|------|
| 5-1. 2개 비교 | "삼성전자와 SK하이닉스 비교" | Research: 각 종목당 Data Worker, Technical Analyst, Trading Flow Analyst (6개 total) + Strategy: Buy Specialist | Standard, 종목별 병렬 | 동일 기준 비교 |
| 5-2. 섹터 비교 | "반도체 종목 중 어디가 좋아?" | Research: 섹터 종목 각각 Data Worker + Bull/Bear Analyst + Strategy: Buy Specialist | Standard, 병렬 | 상대 평가 |
| 5-3. 대체 투자 비교 | "이거 대신 뭐 살까?" | Research: 원 종목 + 대안 후보 각각 분석 + Strategy: Buy Specialist | Standard, 병렬 | 대안 탐색 |

**라우팅**: research_agent + strategy_agent (2개, 병렬)  
**특이사항**: Research Agent가 여러 종목을 동시 분석 (내부 병렬)

---

### 카테고리 6: 시장 상황/전망

**토큰: 1000-2000**

| 시나리오 | 예시 | 서브에이전트 조합 | 실행 방식 | 이유 |
|----------|------|-----------------|----------|------|
| 6-1. 시장 전체 전망 | "지금 시장 어때?", "코스피 전망은?" | Research: Macro Worker, Bull/Bear Analyst (2개) + Strategy | Standard, 병렬 | 거시 + 시장 센티먼트 |
| 6-2. 섹터 전망 | "반도체 업종 어때?", "2차전지 전망은?" | Research: 섹터 주요 종목 Data Worker, Macro Worker (3-4개) + Strategy | Standard, 병렬 | 섹터 대표 종목 분석 |
| 6-3. 경제 지표 영향 | "금리 인상 영향은?", "환율 어떻게 될까?" | Research: Macro Worker (1개) | Standard | 거시경제 분석 |

**라우팅**: research_agent + strategy_agent (2개, 병렬)

---

### 카테고리 7: 포트폴리오 조회/평가

**토큰: 1000-1500**

| 시나리오 | 예시 | 서브에이전트 조합 | 실행 방식 | 이유 |
|----------|------|-----------------|----------|------|
| 7-1. 현황 조회 | "내 포트폴리오 보여줘", "수익률은?" | Portfolio: Market Condition (1개) | Quick | 데이터 조회만 |
| 7-2. 성과 분석 | "지난달 성과는?", "왜 손해야?" | Portfolio: Market Condition, Optimize Allocation (2개) + Risk | Standard, 병렬 | 성과 요인 분석 + 리스크 |
| 7-3. 리스크 체크 | "내 포트폴리오 위험해?", "리스크는?" | Portfolio: Validate Constraints (1개) + Risk | Standard, 병렬 | 제약 조건 + 리스크 측정 |

**라우팅**: portfolio_agent + risk_agent (2개, 병렬)

---

### 카테고리 8: 포트폴리오 변경 제안

**토큰: 3000-5000 (Comprehensive + HITL)**

| 시나리오 | 예시 | 서브에이전트 조합 | 실행 방식 | 이유 |
|----------|------|-----------------|----------|------|
| 8-1. 리밸런싱 | "리밸런싱 해줘", "비중 재조정" | Portfolio: 전체 3개 (Market Condition, Optimize Allocation, Validate Constraints) + Strategy: Buy/Sell Specialist + Risk | Comprehensive, 병렬 → HITL | 전체 최적화 필요 |
| 8-2. 신규 포트폴리오 구성 | "포트폴리오 짜줘", "추천 포트폴리오" | Research: 후보 종목 분석 (Comprehensive) + Portfolio: 전체 3개 + Strategy + Risk | Comprehensive, 순차 (종목 선정 → 최적화) → HITL | 종목 선정 먼저 |
| 8-3. 종목 추가 검토 | "삼성전자 추가할까?", "포트폴리오에 넣을까?" | Research: 대상 종목 Comprehensive + Portfolio: Validate Constraints + Risk | Comprehensive, 병렬 → HITL | 종목 평가 + 제약 체크 |
| 8-4. 종목 제거 검토 | "SK하이닉스 빼야 할까?" | Research: 대상 종목 (Data Worker, Information Analyst) + Strategy: Sell Specialist + Portfolio: Optimize Allocation (재최적화) | Standard, 순차 (제거 타당성 → 재최적화) → HITL | 매도 근거 → 재구성 |

**라우팅**: portfolio_agent + strategy_agent + risk_agent (3개, 병렬 or 순차) + HITL 필수

---

### 카테고리 9: 매매 실행

**토큰: 500-1000 + HITL**

| 시나리오 | 예시 | 서브에이전트 | 실행 방식 | 이유 |
|----------|------|-------------|----------|------|
| 9-1. 단순 매수 | "삼성전자 10주 매수", "100만원어치 사줘" | Trading Agent (1개) | HITL | 매매 실행만 |
| 9-2. 단순 매도 | "SK하이닉스 전량 매도", "절반 팔아줘" | Trading Agent (1개) | HITL | 매매 실행만 |
| 9-3. 조건부 매매 | "손절가 5% 설정", "목표가 도달하면 팔아줘" | Strategy: Risk/Reward Calculator (손절/목표가 계산) + Trading Agent | 병렬 → HITL | 조건 계산 → 실행 |

**라우팅**: trading_agent (1개) + HITL 필수  
**예외**: 9-3은 strategy_agent 선행 필요

---

### 카테고리 10: 복합 명령 (순차 실행)

**토큰: 3000-6000 (Comprehensive × 2)**

| 시나리오 | 예시 | 프로세스 | 실행 방식 |
|----------|------|---------|----------|
| 10-1. 분석 후 매수 | "삼성전자 분석하고 괜찮으면 매수" | ① Research + Strategy + Risk (Comprehensive, 병렬)<br>② Supervisor 판단 (매수 점수 7+ 시)<br>③ Trading Agent (HITL) | 순차 |
| 10-2. 비교 후 매수 | "삼성전자와 SK하이닉스 비교하고 더 좋은 거 사줘" | ① Research + Strategy (2개 종목, 병렬)<br>② Supervisor 판단 (점수 높은 종목 선택)<br>③ Trading Agent (HITL) | 순차 |
| 10-3. 분석 후 리밸런싱 | "포트폴리오 분석하고 리밸런싱" | ① Portfolio + Risk (평가, 병렬)<br>② Portfolio + Strategy + Risk (최적화, 병렬)<br>③ Trading Agent (HITL) | 순차 |

**라우팅**: 순차 실행 (Phase 1 → Phase 2 → Phase 3)  
**특징**: Supervisor가 중간 판단 수행

---

### 카테고리 11: 컨텍스트 의존 질문

**토큰: 가변 (히스토리 참조)**

| 시나리오 | 예시 | 처리 방법 | 실행 방식 |
|----------|------|----------|----------|
| 11-1. 대명사 참조 | "그거 매수해줘", "그 종목 어때?" | 대화 히스토리에서 종목 추출 → 해당 시나리오 실행 | 컨텍스트 해석 |
| 11-2. 이전 대화 참조 | "더 자세히 설명해줘", "왜 그래?" | 이전 메시지 요약 + 추가 분석 | 히스토리 기반 |
| 11-3. 암묵적 의도 | "사야 해?", "어떻게 생각해?" | 컨텍스트에서 종목/상황 파악 → 시나리오 4-1/4-2 실행 | 의도 추론 |

**라우팅**: 컨텍스트 해석 후 해당 시나리오 매칭

---

### 카테고리 12: 애매한/잘못된 요청

**토큰: ~100 (Supervisor 직접 처리)**

| 시나리오 | 예시 | 처리 방법 |
|----------|------|----------|
| 12-1. 불명확한 요청 | "좋은 종목 추천해줘", "돈 벌고 싶어" | Supervisor가 명확화 질문: "투자 성향은?", "선호 섹터는?" |
| 12-2. 존재하지 않는 종목 | "구글 주식 사줘", "테슬라 분석" | "현재 한국 상장 종목만 지원합니다" (정중한 거절) |
| 12-3. 불가능한 요청 | "백만장자 만들어줘", "확실한 거 알려줘" | "투자에는 항상 리스크가 있습니다" (현실적 안내) |
| 12-4. 시스템 한계 | "내일 주가 맞춰봐", "100% 수익률 보장해줘" | 시스템 한계 설명 + 대안 제시 |

**라우팅**: Supervisor 직접 답변 (에이전트 호출 없음)

---

## 🚀 확장 시나리오 (카테고리 13-22)

### 카테고리 13: 투자 학습/교육 요청

**토큰: 500-1500 (Research + Strategy Standard 모드)**

| 시나리오 | 예시 | 서브에이전트 조합 | 실행 방식 | 이유 |
|----------|------|-----------------|----------|------|
| 13-1. 용어/개념 설명 심화 | "PER이 낮으면 왜 좋은 거야?", "배당락일 전략 알려줘" | Supervisor 직접 답변 + Research: Information Analyst (필요시) | Quick | 교육적 콘텐츠 제공 |
| 13-2. 실전 사례 학습 | "이번 반등장에서 어떻게 대응했어야 했어?", "2020년 코로나 때 어떻게 했어야 해?" | Research: Macro Worker, Bull/Bear Analyst (2개) | Standard, 순차 | 역사적 데이터 분석 + 교훈 도출 |
| 13-3. 전략 시뮬레이션 | "만약 내가 작년에 삼성전자만 샀다면?", "물타기 vs 손절 어떤 게 나았을까?" | Research: Data Worker (1개) + Strategy: Risk/Reward Calculator | Standard, 병렬 | 백테스팅 + 가상 시뮬레이션 |
| 13-4. 투자 원칙 수립 | "나만의 투자 원칙 만들고 싶어", "매매 규칙 정해줘" | Strategy: Buy/Sell Specialist (2개) + Risk | Standard, 병렬 | 개인화된 가이드라인 생성 |
| 13-5. 차트 읽는 법 | "이 차트 패턴이 뭐야?", "골든크로스 실전 예시 보여줘" | Research: Technical Analyst (1개) | Standard | 기술적 분석 교육 |

**라우팅**: supervisor (간단) or research_agent (1-2개) + strategy_agent  
**특징**: 교육 목적이므로 HITL 불필요, 단계별 설명 중시

---

### 카테고리 14: 감정 기반 의사결정 지원

**토큰: 1000-2000 (Strategy + Risk Standard 모드)**

| 시나리오 | 예시 | 서브에이전트 조합 | 실행 방식 | 이유 |
|----------|------|-----------------|----------|------|
| 14-1. 불안감 해소 | "계속 떨어지는데 무서워", "패닉셀 할까 봐 두려워" | Research: Data Worker, Information Analyst (2개) + Strategy: Sell Specialist + Risk | Standard, 병렬 | 현황 분석 + 감정적 지원 + 객관적 조언 |
| 14-2. FOMO 대응 | "다들 사는데 나만 안 사면 어떡해?", "급등주 놓칠까 봐 걱정돼" | Research: Data Worker, Trading Flow Analyst (2개) + Risk (과열도 체크) | Standard, 병렬 | 시장 과열 분석 + 리스크 경고 |
| 14-3. 손실 후유증 | "큰 손실 후 다시 시작하려는데 어떻게?", "신뢰 회복하고 싶어" | Strategy: Risk/Reward Calculator + Risk (심리적 평가) | Standard | 재기 전략 + 안전 투자 제안 |
| 14-4. 과신 경계 | "요즘 계속 수익인데 더 공격적으로 가도 돼?", "연승 중이야!" | Portfolio: Validate Constraints + Risk (집중도, 과신 체크) | Standard, 병렬 | 리스크 과다 경고 |
| 14-5. 매매 중독 의심 | "하루에도 몇 번씩 사고파는데 이거 정상이야?" | Portfolio: Market Condition + Risk | Standard | 거래 패턴 분석 + 경고 |

**라우팅**: strategy_agent + risk_agent (2개, 병렬)  
**특징**: 감정 상태 인식 → 객관적 데이터 제시 → 행동 가이드 제공

---

### 카테고리 15: 세금/수수료 최적화

**토큰: 800-1500 (Portfolio + Strategy Standard 모드)**

| 시나리오 | 예시 | 서브에이전트 조합 | 실행 방식 | 이유 |
|----------|------|-----------------|----------|------|
| 15-1. 세금 영향 분석 | "지금 팔면 세금 얼마야?", "양도세 줄이려면?" | Portfolio: Optimize Allocation (세금 고려) | Standard | 세금 계산 + 최적화 |
| 15-2. 절세 전략 | "연말 절세 팁 알려줘", "ISA 계좌 활용법은?" | Supervisor 직접 답변 + Portfolio (필요시) | Quick/Standard | 제도 설명 + 포트폴리오 조정 |
| 15-3. 수수료 비교 | "거래 수수료 너무 높은 것 같아", "환전 비용 줄이려면?" | Trading Agent (수수료 계산) | Quick | 비용 구조 분석 |
| 15-4. 배당 세금 전략 | "배당주 세금 부담 줄이려면?", "배당 재투자 전략은?" | Research: Data Worker (1개) + Strategy: Buy Specialist | Standard, 병렬 | 배당 종목 분석 + 세후 수익 계산 |

**라우팅**: portfolio_agent + trading_agent (2개, 병렬)  
**특징**: 한국 세법 특화 (양도세, 배당소득세 등)

---

### 카테고리 16: 시스템 성과 검증/비교

**토큰: 1000-2000 (Portfolio + Risk Standard 모드)**

| 시나리오 | 예시 | 서브에이전트 조합 | 실행 방식 | 이유 |
|----------|------|-----------------|----------|------|
| 16-1. AI 추천 성과 검증 | "지난번 추천한 삼성전자 결과 어땠어?", "AI 정확도는?" | Portfolio: Market Condition (과거 추천 조회) + Risk (성과 평가) | Standard, 병렬 | 추천 이력 조회 + 성과 분석 |
| 16-2. 벤치마크 비교 | "내 수익률 vs 코스피", "같은 기간 로보어드바이저 평균은?" | Portfolio: Market Condition (1개) + Research: Data Worker (벤치마크) | Standard, 병렬 | 상대 성과 비교 |
| 16-3. 전략별 성과 비교 | "공격형 vs 안정형 어떤 게 나았어?", "섹터별 비교해줘" | Portfolio: Optimize Allocation (시뮬레이션) | Standard | 가상 포트폴리오 비교 |
| 16-4. 신뢰도 체크 | "AI 추천 믿어도 돼?", "과거 적중률은?" | Portfolio + Risk (통계 분석) | Standard | 신뢰성 지표 제공 |

**라우팅**: portfolio_agent + risk_agent (2개, 병렬)  
**특징**: 투명성 제공, 과거 추천 이력 저장 필수

---

### 카테고리 17: 장기 목표/은퇴 계획

**토큰: 2000-4000 (Comprehensive 모드)**

| 시나리오 | 예시 | 서브에이전트 조합 | 실행 방식 | 이유 |
|----------|------|-----------------|----------|------|
| 17-1. 은퇴 자금 계획 | "20년 후 10억 모으려면?", "은퇴 후 월 300만원 받으려면?" | Portfolio: 전체 3개 (목표 기반 최적화) + Strategy + Risk | Comprehensive, 병렬 | 장기 시뮬레이션 + 목표 달성 경로 |
| 17-2. 생애주기 전략 | "30대 포트폴리오 vs 50대", "나이별 전략 바꿔야 해?" | Portfolio: Optimize Allocation + Strategy | Standard, 병렬 | 연령별 자산배분 |
| 17-3. 자녀 교육비 마련 | "10년 후 대학 등록금 1억 필요", "적립식 vs 거치식?" | Portfolio: 전체 3개 + Strategy | Comprehensive, 병렬 | 목표 금액 + 기간 기반 전략 |
| 17-4. 퇴직연금 운용 | "IRP 계좌 로보어드바이저 맡길까?", "퇴직연금 포트폴리오 추천해줘" | Portfolio: 전체 3개 + Strategy + Risk | Comprehensive, 병렬 | 장기 안정성 중시 |

**라우팅**: portfolio_agent + strategy_agent + risk_agent (3개, 병렬) + HITL (실행 시)  
**특징**: 장기 시계열 시뮬레이션, 인플레이션 고려

---

### 카테고리 18: 설명/투명성 요청

**토큰: 500-1000**

| 시나리오 | 예시 | 서브에이전트 조합 | 실행 방식 | 이유 |
|----------|------|-----------------|----------|------|
| 18-1. 추천 근거 설명 | "왜 이걸 추천했어?", "판단 기준이 뭐야?" | Supervisor (이전 분석 요약) | Quick | 과거 분석 결과 재제시 |
| 18-2. 점수 상세 설명 | "매수 점수 7점인 이유는?", "각 항목별 점수 알려줘" | Strategy: Buy Specialist (상세 분해) | Standard | 점수 산출 근거 투명화 |
| 18-3. 리스크 상세 분석 | "왜 위험하다고 했어?", "리스크 요인 하나하나 설명해줘" | Risk (상세 분해) | Standard | 리스크 요소별 설명 |
| 18-4. 대안 제시 요청 | "다른 옵션은 없어?", "2순위 추천은?" | Strategy: Buy Specialist (대안 종목) | Standard | 복수 옵션 제공 |
| 18-5. 과거 결정 회고 | "그때 왜 그렇게 추천했어?", "지금 보면 어때?" | Portfolio + Risk (과거 분석 재평가) | Standard | 학습과 개선 |

**라우팅**: supervisor or 원래 분석 담당 에이전트 재호출  
**특징**: XAI(Explainable AI) 기능, 사용자 신뢰 구축

---

### 카테고리 19: 알림/자동화 설정

**토큰: 300-800 + Persistent Storage**

| 시나리오 | 예시 | 서브에이전트 조합 | 실행 방식 | 이유 |
|----------|------|-----------------|----------|------|
| 19-1. 가격 알림 설정 | "삼성전자 5만원 되면 알려줘", "10% 하락하면 알람" | Trading Agent (알림 등록) | Quick | 조건 모니터링 |
| 19-2. 뉴스 알림 설정 | "삼성전자 중요 뉴스 나오면 알려줘", "반도체 섹터 악재 알림" | Research: Information Analyst (알림 등록) | Quick | 실시간 모니터링 |
| 19-3. 정기 리포트 | "매주 월요일 포트폴리오 리포트 보내줘", "월간 시장 요약해줘" | Portfolio: Market Condition (스케줄 등록) | Quick | 자동 보고서 생성 |
| 19-4. 자동 리밸런싱 | "분기마다 자동으로 리밸런싱해줘", "편차 10% 넘으면 조정" | Portfolio: Optimize Allocation (자동화) + HITL | Standard → HITL | 조건 기반 자동 실행 |
| 19-5. 배당일 알림 | "보유 종목 배당락일 알려줘", "배당 입금되면 재투자" | Research: Data Worker (배당 일정) + Trading (조건부) | Standard | 배당 관리 자동화 |

**라우팅**: trading_agent + research_agent (알림용) + scheduler  
**특징**: 영구 저장소 필요, 조건 기반 트리거

---

### 카테고리 20: 소셜/벤치마킹 기능

**토큰: 1000-2000 (Research + Strategy Standard 모드)**

| 시나리오 | 예시 | 서브에이전트 조합 | 실행 방식 | 이유 |
|----------|------|-----------------|----------|------|
| 20-1. 시장 센티먼트 | "지금 개미들 뭐 사고 있어?", "외국인 동향은?" | Research: Trading Flow Analyst, Information Analyst (2개) | Standard, 병렬 | 투자자 심리 분석 |
| 20-2. 인기 종목 순위 | "요즘 핫한 종목 Top10", "MZ세대가 많이 사는 주식은?" | Research: Data Worker, Trading Flow Analyst (2개) | Standard, 병렬 | 트렌드 분석 |
| 20-3. 전문가 의견 수집 | "증권사 리포트 종합해줘", "애널리스트 컨센서스는?" | Research: Information Analyst (1개) | Standard | 전문가 의견 취합 |
| 20-4. 유사 포트폴리오 | "나와 비슷한 사람들은 어떻게 투자해?", "같은 성향 수익률은?" | Portfolio: Market Condition + Risk (익명 벤치마크) | Standard | 피어 그룹 비교 |
| 20-5. 커뮤니티 이슈 | "지금 주식 커뮤니티 핫이슈는?", "논란 종목 있어?" | Research: Information Analyst (1개) | Standard | 소셜 모니터링 |

**라우팅**: research_agent (2개, 병렬)  
**특징**: 개인정보 보호 준수, 익명화된 집단 데이터 활용

---

### 카테고리 21: 시나리오 시뮬레이션

**토큰: 1500-3000 (Research + Portfolio Comprehensive 모드)**

| 시나리오 | 예시 | 서브에이전트 조합 | 실행 방식 | 이유 |
|----------|------|-----------------|----------|------|
| 21-1. What-if 분석 | "금리 1% 더 오르면 내 포트폴리오는?", "환율 1500원 되면?" | Research: Macro Worker (1개) + Portfolio: Optimize Allocation | Standard, 순차 | 시나리오 입력 → 영향 분석 |
| 21-2. 위기 상황 대비 | "2008년 금융위기 수준 폭락하면?", "전쟁 나면 어떻게 대응?" | Research: Macro Worker, Bull/Bear Analyst (2개) + Risk | Standard, 병렬 | 극단 시나리오 + 방어 전략 |
| 21-3. 목표 달성 확률 | "이 전략으로 1억 모을 확률은?", "3년 내 목표 달성 가능성?" | Portfolio: 전체 3개 (몬테카를로 시뮬레이션) | Comprehensive | 확률적 분석 |
| 21-4. 최악 시나리오 | "최악의 경우 얼마나 잃을 수 있어?", "MDD(최대낙폭)는?" | Risk (스트레스 테스트) + Portfolio | Standard, 병렬 | 하방 리스크 분석 |
| 21-5. 섹터 로테이션 | "경기 회복기면 어떻게 바꿔야 해?", "경기 사이클별 전략" | Research: Macro Worker (1개) + Portfolio: Optimize Allocation | Standard, 순차 | 국면별 최적 배분 |

**라우팅**: research_agent + portfolio_agent + risk_agent (3개, 순차/병렬)  
**특징**: 가상 시뮬레이션, 확률 분포 제공

---

### 카테고리 22: 뉴스/이벤트 대응

**토큰: 1000-2000 (Research + Strategy Standard 모드)**

| 시나리오 | 예시 | 서브에이전트 조합 | 실행 방식 | 이유 |
|----------|------|-----------------|----------|------|
| 22-1. 돌발 뉴스 대응 | "삼성전자 급락 이유가 뭐야?", "갑자기 급등했는데?" | Research: Information Analyst (1개) → Strategy: Buy/Sell Specialist | Standard, 순차 | 뉴스 분석 → 대응 전략 |
| 22-2. 실적 발표 대응 | "오늘 실적 발표인데 어떻게 해?", "어닝 서프라이즈 확률은?" | Research: Data Worker, Information Analyst (2개) + Strategy | Standard, 병렬 | 실적 예측 + 대응 전략 |
| 22-3. 공시 대응 | "유상증자 공시 떴는데 어떻게 해?", "자사주 매입 호재야?" | Research: Information Analyst (1개) + Strategy: Sell/Buy Specialist | Standard, 순차 | 공시 해석 → 의사결정 |
| 22-4. 매크로 이벤트 | "FOMC 결과 나왔는데", "한은 금리 결정 어떻게 봐?" | Research: Macro Worker (1개) + Portfolio: Optimize Allocation | Standard, 순차 | 거시 이벤트 → 포트폴리오 영향 |
| 22-5. 이슈 종목 스캔 | "오늘 이슈된 종목 알려줘", "상한가 종목 분석해줘" | Research: Information Analyst, Trading Flow Analyst (2개) | Standard, 병렬 | 실시간 이슈 스캐닝 |

**라우팅**: research_agent + strategy_agent (2개, 순차)  
**특징**: 실시간성 중요, 빠른 응답 필요

---

## 📊 구현 우선순위 및 고려사항

### **Phase 1: 핵심 기능 (필수)**

**카테고리**:
- 1-4 (간단한 질의 ~ 투자 의사결정)
- 7-9 (포트폴리오 조회 ~ 매매 실행)
- 13 (투자 학습/교육)
- 16 (성과 검증)
- 18 (설명/투명성)

**이유**: 기본적인 투자 분석 → 실행 → 신뢰 구축의 핵심 플로우

---

### **Phase 2: 차별화 기능 (중요)**

**카테고리**:
- 5-6 (종목 비교, 시장 전망)
- 14 (감정 지원)
- 19 (알림/자동화)
- 22 (뉴스 대응)

**이유**: 사용자 경험 향상, 지속적 사용 유도

---

### **Phase 3: 고급 기능 (고도화)**

**카테고리**:
- 10 (복합 명령)
- 17 (장기 계획)
- 21 (시나리오 시뮬레이션)
- 20 (소셜)
- 15 (세금 최적화)

**이유**: 전문성 강화, 장기 고객 유지

---

## 🔑 핵심 구현 고려사항

### **1. 메모리/컨텍스트 관리**
```
✅ 세션 간 연속성
- 과거 대화 이력 저장
- 추천 이력 추적
- 사용자 선호도 학습

✅ 개인화
- 투자 성향 프로파일링
- 리스크 선호도 저장
- 과거 행동 패턴 분석

✅ 컨텍스트 윈도우 최적화
- 중요 정보 우선순위화
- 오래된 정보 압축/요약
- 토큰 효율 관리
```

### **2. 감정 인식 및 대응**
```
✅ 감정 상태 감지
- 불안: "무서워", "걱정돼"
- FOMO: "다들 사는데", "놓칠까 봐"
- 과신: "계속 수익", "연승 중"
- 후회: "잘못 판 것 같아"

✅ 맞춤형 커뮤니케이션
- 불안 시: 객관적 데이터 + 안정적 조언
- FOMO 시: 리스크 경고 + 대안 제시
- 과신 시: 위험 신호 강조
```

### **3. 투명성과 신뢰**
```
✅ 설명 가능성 (XAI)
- 모든 추천에 근거 명시
- 점수 산출 과정 공개
- 대안 옵션 제시

✅ 성과 추적
- 과거 추천 결과 공개
- 정확도 통계 제공
- 실패 사례도 투명하게

✅ 불확실성 표현
- 확률적 표현 사용
- "~일 가능성이 높습니다"
- "100% 확실"이라는 표현 금지
```

### **4. 규제 준수**
```
✅ 투자 권유 vs 정보 제공
- 명확한 경계 설정
- "추천"보다 "정보 제공" 표현

✅ 리스크 고지
- 모든 투자 조언에 리스크 경고
- "투자에는 원금 손실 위험이 있습니다"

✅ HITL (Human-in-the-Loop)
- 실제 매매는 반드시 사용자 확인
- 자동 실행 전 명시적 동의
```

### **5. 실시간성**
```
✅ 데이터 신선도
- 시장 데이터: 15-20분 지연 허용
- 뉴스: 가능한 실시간
- 공시: 즉시 반영

✅ 알림 시스템
- 중요 이벤트 실시간 푸시
- 사용자 정의 조건 모니터링
- 배치 처리와 실시간 처리 분리
```

### **6. 개인정보 보호**
```
✅ 데이터 최소화
- 필요한 정보만 수집
- 민감 정보 암호화

✅ 익명화
- 벤치마킹 시 개인정보 제거
- 집단 통계만 활용

✅ 사용자 제어
- 데이터 삭제 권한
- 수정 권한
- 공유 설정 제어
```

---

## 📈 성공 지표 (KPI)

### **사용자 참여도**
- DAU/MAU (일간/월간 활성 사용자)
- 세션당 평균 대화 수
- 재방문율
- 카테고리별 사용 빈도

### **신뢰도**
- AI 추천 수용률
- 성과 검증 요청 빈도
- 설명 요청 빈도
- 사용자 피드백 점수

### **비즈니스 성과**
- 매매 실행 전환율
- 포트폴리오 구성/리밸런싱 실행률
- 평균 거래 규모
- 고객 생애 가치 (LTV)

### **기술 성과**
- 평균 응답 시간
- 에이전트 호출 성공률
- 토큰 효율성
- 시스템 가용성

---

## 🎯 최종 체크리스트

### **기능 완성도**
- [ ] 모든 22개 카테고리 구현
- [ ] HITL 프로세스 구현
- [ ] 에이전트 간 병렬/순차 실행
- [ ] 컨텍스트 관리 시스템

### **사용자 경험**
- [ ] 자연스러운 대화 흐름
- [ ] 감정 인식 및 대응
- [ ] 명확한 설명 제공
- [ ] 오류 처리 및 대안 제시

### **신뢰 및 안전**
- [ ] 투명한 추천 근거
- [ ] 성과 추적 시스템
- [ ] 리스크 고지
- [ ] 규제 준수

### **기술 인프라**
- [ ] 메모리/저장소 시스템
- [ ] 실시간 알림 시스템
- [ ] 성능 모니터링
- [ ] 보안 및 개인정보 보호

---

**문서 버전**: 2.0  
**최종 업데이트**: 2025-11-02  
**총 카테고리**: 22개  
**총 시나리오**: 100+개
